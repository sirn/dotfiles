#!/usr/bin/env ksh
#
# ~/.kshrc
#

# Exit early for non-interactive
#
case "$-" in
    *i* )
        ;;

    * )
        return 0
        ;;
esac


## History
##

HISTFILE="$HOME/.ksh_history"
HISTSIZE=10000

export HISTFILE
export HISTSIZE


## Aliases
##

# shellcheck disable=SC2010
if command -v colorls >/dev/null; then
    alias ls="colorls -G"
elif ls --version 2>&1 |grep -qe "BusyBox" -e "GNU"; then
    alias ls="ls --color"
elif ls -G >/dev/null 2>&1 ; then
    alias ls="ls -G"
fi

alias ll='ls -lh'
alias la='ls -alh'
alias sshi='ssh -F /dev/null -o UserKnownHostsFile=/dev/null'

if [ -f /etc/os-release ]; then
    unset OS_RELEASE

    OS_RELEASE=$(awk '/^ID=/ {
        match($0, "^.*=\"?([^\"]+)\"?$", a);
        print a[1]
    }' < /etc/os-release)
fi

case "$OS_RELEASE" in
    void )
        if ! command -v xi >/dev/null; then
            alias xi="sudo xbps-install"
        fi

        alias xlocal="xbps-query -p repository -s $HOME"
        ;;

    * )
        ;;
esac


## GPG
##

if command -v gpg-connect-agent >/dev/null; then
    GPG_TTY=$(tty)
    export GPG_TTY

    gpg-connect-agent updatestartuptty /bye >/dev/null
fi


## Prompt
##

case "$TERM" in
    xterm* | rxvt* ) PS1="\h \w \$ ";;
    screen* ) PS1="\w \$ ";;
    * ) PS1="\$ ";;
esac

export PS1
unset OS_RELEASE
