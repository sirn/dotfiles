#!/bin/sh
#
# ~/.profile
#
umask 077

LC_ALL=en_US.UTF-8
LANG=en_US.UTF-8
EDITOR="vi"
VISUAL="emacs"

export LC_ALL
export LANG
export EDITOR
export VISUAL

XDG_CONFIG_HOME=$HOME/.config
XDG_CACHE_HOME=$HOME/.cache
XDG_DATA_HOME=$HOME/.data
XDG_STATE_HOME=$HOME/.state

export XDG_CONFIG_HOME
export XDG_CACHE_HOME
export XDG_DATA_HOME
export XDG_STATE_HOME

PATH=/sbin:/bin:/usr/X11R6/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
PATH=$PATH:$HOME/.local/bin:$HOME/.cabal/bin:$HOME/.cargo/bin

GOPATH=$HOME/Dev/go
PATH=$PATH:$GOPATH/bin
export GOPATH

# Note: leading colon to append to default MANPATH
MANPATH=:$HOME/.local/man
export MANPATH

RUST_SRC_PATH="$HOME/.local/lib/rustlib/src/rust/src"
export RUST_SRC_PATH


## Platform-specific
##

case "$(uname)" in
    Darwin )
        PATH=/opt/local/bin:$PATH

        if [ -f /usr/libexec/java_home ]; then
            JAVA_HOME=$(/usr/libexec/java_home)
            export JAVA_HOME
        fi

        for pypath in "$HOME"/Library/Python/?.?/bin; do
            if [ -d "$pypath" ]; then
                PATH=$PATH:$pypath
            fi
        done

        PATH=$PATH:/Applications/mpv.app/Contents/MacOS
        ;;

    OpenBSD )
        # shellcheck disable=SC2039
        ulimit -c 0

        for jdkpath in /usr/local/jdk-*/bin; do
            if [ -d "$jdkpath" ]; then
                PATH=$PATH:$jdkpath
            fi
        done
        ;;
esac


## Local
##

if [ -d "$HOME/.cache/rebar3/bin" ]; then
    PATH=$PATH:$HOME/.cache/rebar3/bin
fi

for rbpath in "$HOME"/.gem/ruby/?.?/bin; do
    if [ -d "$rbpath" ]; then
        PATH=$PATH:$rbpath
    fi
done


## GPG agent
##

if command -v gpgconf >/dev/null; then
    unset SSH_AGENT_PID

    if [ "${gnupg_SSH_AUTH_SOCK_by:-0}" -ne $$ ]; then
        SSH_AUTH_SOCK="$(gpgconf --list-dirs agent-ssh-socket)"
        export SSH_AUTH_SOCK
    fi

    GPG_TTY=$(tty)
    export GPG_TTY
fi


## Finalizing
##

if [ -n "$KSH_VERSION" ]; then
    ENV="$HOME/.kshrc"
    export ENV
fi

export PATH
